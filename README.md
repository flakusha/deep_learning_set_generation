# Deep Learning Set Generation - DLSG - Генерация сетов для обучения машинного зрения

## Использование плагина и требования
* Для работы плагина требуется плагин для генерации труб:
https://gitlab.com/yeus/piperator/uploads/bf5033ee1ed2478128cf22c1826c1bdb/piperator.zip
* Для работы аддона требуется файл **Tubes.blend** (идёт в комплекте, в архиве с релизом),
в нём произведены все необходимые настройки сцены, материалов и композитора для создания
пар изображений рендер <-> повреждения
* После установки аддона, необходимо собрать бинарный файл приложения на Rust,
которое будет выполнять поиск доменов в изображении damage_....png. Сборка выполняется переходом в папку с аддонами:
    * Windows: Users\user\AppData\Roaming\Blender Foundation\Blender\2.93\addons\scripts\dlsg
    * Linux: /home/user/.config/blender/2.93/addons/scripts/dlsg/
    * Команда для сборки: `cargo build --release`, исполняемый файл будет размещён в папке target/release/
    в которой плагин и будет использовать созданный исполняемый файл
* После завершения сборки в файле Tubes.blend выбирается объект (делается активным),
на котором необходимо генерировать трубы.
У данного объекта должно присутствовать три материала:
    * Material - стандартный материал, который используется для покраски "стены" под трубами
    * Pipe_Support - материал для компонентов поддержки труб и фланцев
    * Pipe_Material - материал труб с процедурно генерируемыми повреждениями
* Во вкладке Properties, там, где находятся настройки рендера, должна появиться панель DLSG с
кнопкой "Generate Image", после нажатия на эту кнопку, все трубы будут переустановлены заново и
будет произведена настройка материалов, выполнен рендер в указанном разрешении и в результате
рендера будет создано два изображения: "фотореалистичное" с трубами и карта повреждений, где на
прозрачном фоне белым будут указаны повреждения
* После рендера изображений, программа поиска доменов откроет изображение с повреждениями и
выполнит свою работу, после чего запишет файл текстовый файл *.yolo
* Все файлы выгружаются в ту же папку, где находится открытый Blend файл
* Немного более подробный лог выполнения программы можно увидеть в консоли

## Использованные библиотеки:
* Piperator - плагин для создания труб по центрам полигонов выбранного объекта
* Image - библиотека чтения и работы с изображениями на Rust

## Пути улучшения программы:
* Замена алгоритма генерации труб на более совершенный со слоями труб, выполненными по предоставленным
референсам, более близким к реальным трубам
* Улучшение материалов, больше вариантов повреждений, более случайное расположение повреждений на объектах
* Генерация различных вариантов освещения для одного и того же рендера
* Генерация деформаций как самой геометрии труб, так и материалов, создание карт повреждений для
гнутых и деформированных труб
* Многопоточный поиск доменов